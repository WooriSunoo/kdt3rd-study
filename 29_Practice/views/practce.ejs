<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- axios CDN -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <h1><%= title %></h1>
    <br />
    <form name="register">
      ì´ë¦„ <input type="text" name="id" required />
      <fieldset>
        <legend>ì„±ë³„</legend>
        <input type="radio" name="gender" value="male" required />ë‚¨ì
        <input type="radio" name="gender" value="female" required />ì—¬ì
      </fieldset>

      <fieldset>
        <legend>ìƒë…„ì›”ì¼</legend>
        <select name="years">
          <% for (let i = 1961; i < 2021; i++){ %>
          <option value="<%=i%>"><%=i%></option>
          <% } %>
        </select>
        ë…„
        <select name="month">
          <% for (let i = 1; i < 13; i++){ %>
          <option value="<%=i%>"><%=i%></option>
          <% } %>
        </select>
        ì›”
        <select name="day">
          <% for (let i = 1; i < 32; i++){ %>
          <option value="<%=i%>"><%=i%></option>
          <% } %>
        </select>
        ì¼
      </fieldset>
      <fieldset>
        <legend>ê´€ì‹¬ì‚¬</legend>
        <input type="checkbox" name="fav" value="tour" />ì—¬í–‰
        <input type="checkbox" name="fav" value="fashion" />íŒ¨ì…˜
        <input type="checkbox" name="fav" value="food" />ìŒì‹
      </fieldset>
      <br />
      <button type="button" onclick="axiosGet();">íšŒì›ê°€ì…</button>
    </form>
    <!-- <a href="/">í™ˆìœ¼ë¡œ ì´ë™</a> -->

    <!-- <form action="/postForm" name="login2" method="post">
      <h2>POSTìš”ì²­</h2>
      <input type="text" name="id" placeholder="ID" />
      <input type="password" name="pw" placeholder="PW" />
      <button type="submit">ì œì¶œ</button>
    </form> -->

    <div class="result"></div>

    <br />

    <h1>ì‹¤ìŠµ30. axios post ë¡œê·¸ì¸</h1>
    <form name="login">
      <input type="text" name="id2" required />
      <input type="password" name="pw" required />
      <button type="button" onclick="axiosPost();">ë¡œê·¸ì¸</button>
    </form>

    <div class="result2"></div>

    <script>
      const resultBox = document.querySelector(".result");
      const resultBox2 = document.querySelector(".result2");

      function axiosGet() {
        console.log("####### click axiosGet #######");

        const form = document.forms["register"];
        const data = {
          name: form.id.value,
        };

        // AXIOS ë¹„ë™ê¸° í†µì‹  - GET ìš”ì²­
        axios({
          method: "GET",
          url: "/axios",
          params: data, //GETìš”ì²­ì€ paramsì— ì •ë³´ë¥¼ì‹¤ì–´ì„œ ë³´ë‚´ì•¼ë¨
        }).then(function (response) {
          //axoisëŠ” promiseë¥¼ ë°˜í™˜í•œë‹¤.
          console.log(response); //ì„œë²„ì˜ ì‘ë‹µê²°ê³¼
          console.log(response.data); //res.send(req.query)
          console.log(response.data.name);

          // res.data.nameê°€ëŠ¥

          resultBox.textContent = `${data.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤! ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`;
          resultBox.style.color = "blue";
        });
      }
      function axiosPost() {
        console.log("####### click axiosPost #######");

        const form = document.forms["login"];

        console.log("1", form.id2.checkValidity());
        // genderëŠ”ë°°ì—´í˜•íƒœ
        console.log("2", form.pw.checkValidity());
        const data = {
          id2: form.id2.value,
          pw: form.pw.value,
        };
        // ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ë©´  axiosìš”ì²­ ì‹œë„
        // ì˜¬ë°”ë¥´ì§€ì•Šë‹¤ë©´   axiosìš”ì²­ ì‹œë„X->ê²½ê³ ë©”ì‹œì§€

        if (form.id2.checkValidity() === true && form.pw.checkValidity()) {
          axios({
            method: "POST",
            url: "/axios",
            data: data, // POST ìš”ì²­ì€ "data"ì— ì •ë³´ë¥¼ ì‹¤ì–´ì„œ ë³´ë‚´ì•¼ ë¨
          }).then(function (response) {
            console.log(response);
            console.log(response.data);
            console.log(response.data.check);
            if (response.data.check == true) {
              resultBox2.textContent = `${data.id2}ë‹˜! ë¡œê·¸ì¸ ì„±ê³µğŸ˜€ğŸ˜`;
              resultBox2.style.color = "blue";
              // resultBox2.classList.remove('error')
              // resultBox2.classList.add('sucess')
            } else {
              resultBox2.textContent = `ì•„ì´ë”” ë˜ëŠ” íŒ¨ìŠ¤ì›Œë“œ ì˜¤ë¥˜ğŸ˜“`;
              resultBox2.style.color = "red";
            }
          });
        } else {
          resultBox2.textContent = `ì•„ì´ë”” ë˜ëŠ” íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”ğŸ’¦`;
          resultBox2.style.color = "red";
        }
      }
    </script>
  </body>
</html>
